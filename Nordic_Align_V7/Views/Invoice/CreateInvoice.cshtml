@using Nordic_Align_V7.ViewModels
@model InvoiceViewModel



<h1>Skapa faktura</h1>

<form method="post" action="/Invoice/CreateInvoice">
    <h2>Fakturadetaljer</h2>
    <label for="InvoiceNumber">Fakturanummer:</label>
    <input type="text" id="InvoiceNumber" name="InvoiceNumber" required>
    <br>

    <label for="IssueDate">Utfärdandedatum</label>
    <input type="date" id="IssueDate" name="IssueDate" required onchange="calculateDueDate()">
    <br>

    <label for="DueDate">Förfallodatum:</label>
    <input type="date" id="DueDate" name="DueDate" readonly>
    <br>

    <h2>Kunduppgifter</h2>
    <label for="CompanyName">Företag:</label>
    <input type="text" id="CompanyName" name="CompanyName" required>
    <br>

    <label for="Street">Adress:</label>
    <input type="text" id="Street" name="Street" required>
    <br>

    <label for="City">Stad:</label>
    <input type="text" id="City" name="City" required>
    <br>

    <label for="PostalCode">Postnummer:</label>
    <input type="text" id="PostalCode" name="PostalCode" required>
    <br>

    <label for="Country">Land:</label>
    <input type="text" id="Country" name="Country" required>
    <br>

    <label for="Email">E-post:</label>
    <input type="email" id="Email" name="Email" required>
    <br>

    <label for="Phone">Telefon:</label>
    <input type="text" id="Phone" name="Phone">
    <br>

    <h2>Produkter</h2>
    <div id="items-container">
        @for (int i = 0; i < 1; i++)
        {
            <div class="item-row">
                <label for="Items[@i].Item">Produkt:</label>
                <input type="text" name="itemNames[]" required>

                <label for="Items[@i].Quantity">Antal:</label>
                <input type="number" name="quantities[]" required>

                <label for="Items[@i].Price">Pris:</label>
                <input type="number" step="0.01" name="prices[]" required>



            </div>
        }
    </div>



    <button type="button" onclick="addItem()">Lägg till produkt</button>
    <br><br>
    @*     Add komment om vi vill*@   

    <h2>Kommentar (valfritt)</h2>
    <label for="Comment">Kommentar:</label>
    <textarea id="Comment" name="Comment" rows="4" cols="50"></textarea>
    <br>

    <button type="submit">Generera och skicka</button>
</form>

<script>
    let itemIndex = 1; 
        function addItem() {
        const container = document.getElementById("items-container");
        const div = document.createElement("div");
        div.classList.add("item-row");
        div.innerHTML = `
            <label>Produkt:</label>
            <input type="text" name="itemNames[]" required>

            <label>Antal:</label>
            <input type="number" name="quantities[]" required>

            <label>Pris:</label>
            <input type="number" step="0.01" name="prices[]" required>
        `;
        container.appendChild(div);
    }

    function calculateDueDate() {
        const issueDateInput = document.getElementById("IssueDate");
        const dueDateInput = document.getElementById("DueDate");

        if (issueDateInput.value) {
            let issueDate = new Date(issueDateInput.value);
            issueDate.setDate(issueDate.getDate() + 30); 

            let dueDateStr = issueDate.toISOString().split("T")[0]; 
            dueDateInput.value = dueDateStr;
        }
    }
</script>

